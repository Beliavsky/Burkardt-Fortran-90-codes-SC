<html>

  <head>
    <title>
      FLOW7 - An Experimental Finite Element Code for Fluid Flow
    </title>
  </head>

  <body bgcolor="#EEEEEE" link="#CC0000" alink="#FF3300" vlink="#000055">

    <h1 align = "center">
      FLOW7 <br> An Experimental Finite Element Code <br>
      for Steady Incompressible 2D Navier Stokes Fluid Flow
    </h1>

    <hr>

    <p>
      <b>FLOW7</b> 
      is a FORTRAN90 program which 
      applies the finite element method 
      to solve the steady incompressible Navier Stokes equations 
      in a 2D region for velocity and pressure.
    </p>

    <p>
      To solve a particular problem, you
      need to include routines that define the shape of the region
      and the boundary conditions.  Problems that are already written up
      include
      <ul>
        <li>
          <b>channel</b> - a rectangular channel with noslip walls;
        </li>
        <li>
          <b>driven cavity</b> - a square with an open top, along which a
          tangential flow is specified.
        </li>
        <li>
          <b>freeslip</b> - a rectangular channel with freeslip walls
        </li>
        <li>
          <b>step</b> - a channel with a rectangular obstacle on the bottom wall.
        </li>
      </ul>
    </p>

    <p>
      <b>FLOW7</b> is derived from the FLOW6 code, but is currently 
      under development.  Intended alterations will include:
      <ul>
        <li>
          Sparse matrix storage for the jacobian;
        </li>
        <li>
          CGS or BICGSTAB iteration;
        </li>
      </ul>
    </p>

    <h3 align = "center">
      Languages:
    </h3>

    <p>
      <b>FLOW7</b> is available in 
      <a href = "flow7.html">a FORTRAN90 version</a> 
    </p>

    <h3 align = "center">
      Related Data and Programs:
    </h3>

    <p>
      <a href = "../bump/bump.html"> 
      BUMP</a>
      is a FORTRAN90 program which solves a fluid flow problem
      in a channel including a bump which obstructs and redirects the flow.
    </p>

    <p>
      <a href = "../channel/channel.html"> 
      CHANNEL</a>
      is a FORTRAN90 program which computes the pressure
      and velocity for a Navier Stokes flow in a channel.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/direction_arrows/direction_arrows.html">
      DIRECTION_ARROWS</a>  
      is a MATLAB program which
      can be used to plot the vector direction field.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/direction_arrows2/direction_arrows2.html">
      DIRECTION_ARROWS2</a>  
      is a MATLAB program which 
      plots the velocity direction field, assuming that the XY and
      UV data are stored in a <i>single</i> table file.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/direction_arrows_grid/direction_arrows_grid.html">
      DIRECTION_ARROWS_GRID</a>  
      is a MATLAB program which reads files of
      node and velocity data, and, using interpolation, creates a 
      velocity direction plot with arrows
      place on a uniform grid of the user's specification.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/direction_arrows_sequence/direction_arrows_sequence.html">
      DIRECTION_ARROWS_SEQUENCE</a>  
      is a MATLAB program which 
      plots the velocity direction fields of many data files
      with names that are numbered in sequence.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/data/fem/fem.html">
      FEM</a>  
      is a data directory which contains a description of the data files
      that can be used to describe a finite element model.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/fem_50/fem_50.html">
      FEM_50</a>  
      is a MATLAB finite element program in just 50 lines of code.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/fem_50_heat/fem_50_heat.html">
      FEM_50_HEAT</a>  
      is modified version of <b>FEM_50</b> suitable
      for solving the heat equation.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/fem_50_heat/fem_50_heat.html">
      FEM_50_HEAT</a>  
      is modified version of <b>FEM_50</b> suitable
      for solving the heat equation.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/fem_basis_t3_display/fem_basis_t3_display.html">
      FEM_BASIS_T3_DISPLAY</a>  
      is a MATLAB program which displays a 
      basis function associated with a linear triangle ("T3") mesh.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/fem_basis_t6_display/fem_basis_t6_display.html">
      FEM_BASIS_T6_DISPLAY</a>  
      is a MATLAB program which 
      displays a basis function associated with a quadratic triangle ("T6") mesh.
    </p>

    <p>
      <a href = "../fem_io/fem_io.html">
      FEM_IO</a>  
      is a FORTRAN90 library of routines for reading or writing
      the node, element and data files that define a finite element model.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/fem_to_tec/fem_to_tec.html">
      FEM_TO_TEC</a>  
      is a MATLAB program that can convert an FEM model
      into a TEC graphics file.
    </p>

    <p>
      <a href = "../fem2d_pack/fem2d_pack.html">
      FEM2D_PACK</a> 
      is a FORTRAN90 library which
      contains utilities for 2D finite element calculations.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/ffns_sparse/ffns_sparse.html">
      FFNS_SPARSE</a>  
      is a MATLAB program for solving the 
      steady incompressible Navier Stokes equations 
      on an arbitrary triangulated region, using the finite element method
      and MATLAB's <b>sparse</b> facility.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/ffs_sparse/ffs_sparse.html">
      FFS_SPARSE</a>  
      is a MATLAB program for solving the 
      steady incompressible Stokes equations 
      on an arbitrary triangulated region, using the finite element method
      and MATLAB's <b>sparse</b> facility.
    </p>

    <p>
      <a href = "../flow3/flow3.html"> 
      FLOW3</a>  
      is an earlier
      version of the FLOW7 program.
    </p>

    <p>
      <a href = "../flow5/flow5.html"> 
      FLOW5</a>  
      is an earlier
      version of the FLOW7 program.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/f_src/free_fem_navier_stokes/free_fem_navier_stokes.html">
      FREE_FEM_NAVIER_STOKES</a>  
      is a FORTRAN90 program which 
      solves the 2D incompressible Navier Stokes equations in an arbitrary
      triangulated region (this program is not working yet).
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/f_src/free_fem_stokes/free_fem_stokes.html">
      FREE_FEM_STOKES</a>  
      is a FORTRAN90 program for the
      steady incompressible 2D Stokes equations on an arbitrary
      triangulated region.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/hot_pipe/hot_pipe.html">
      HOT_PIPE</a>  
      is a sample problem that can be run with <b>FEM_50_HEAT</b>.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/hot_point/hot_point.html">
      HOT_POINT</a>  
      is a sample problem that can be run with <b>FEM_50_HEAT</b>.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/f77_src/inout/inout.html">
      INOUT</a>  
      is a FORTRAN77 program which computes the pressure
      and velocity for a Navier Stokes flow in a square region with
      an inlet and an outlet.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/cpp_src/nast2d/nast2d.html">
      NAST2D</a>  
      is a C++ program which computes the pressure
      and velocity for a Navier Stokes flow.  
    </p>

    <p>
      <a href = "../nast2d_f90/nast2d_f90.html">
      NAST2D_F90</a>  
      is a FORTRAN90 program which 
      uses the finite volume method to set up and solve 
      the 2D incompressible Navier Stokes equations with heat.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/c_src/nsasm/nsasm.html"> 
      NSASM</a>
      is a C library of routines, intended to be used with a MATLAB
      calling program, and which set up the sparse matrix needed for
      a Newton iteration to solve a finite element formulation of
      the steady incompressible 2D Navier Stokes equations.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/f77_src/pltmg_single/pltmg_single.html">
      PLTMG_SINGLE</a>  
      is a FORTRAN77 library for solving
      elliptic partial differential equations using the finite
      element method with piecewise linear triangles and the
      multigrid approach.
    </p>

    <p>
      <a href = "../plot_points/plot_points.html">
      PLOT_POINTS</a>  
      is a FORTRAN90 program that can
      make a plot of the nodes that define the region.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/data/table/table.html">
      TABLE</a>  
      is a format used to store the input and output files
      used by the program.
    </p>

    <p>
      <a href = "../table_io/table_io.html"> 
      TABLE_IO</a> 
      is a FORTRAN90 library of routines needed to read the data files.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/f77_src/tcell/tcell.html">
      TCELL</a>  
      is a FORTRAN77 program which
      computes the pressure and velocity for a Navier Stokes flow in a "T"-shaped region.  
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/toms866/toms866.html">
      TOMS866</a>
      a MATLAB library which
      is the Incompressible Flow Iterative Solution Software;<br>
      this library is commonly called <b>IFISS</b>;<br>
      this is ACM TOMS algorithm 866. 
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/data/triangulation_order3/triangulation_order3.html">
      TRIANGULATION_ORDER3</a>  
      is a data directory containing a description
      and examples of an order 3 triangulation.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/triangulation_order3_contour/triangulation_order3_contour.html">
      TRIANGULATION_ORDER3_CONTOUR</a> 
      is a MATLAB script
      which can be used to make contour plots of the pressure field
      from these files.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/data/triangulation_order6/triangulation_order6.html">
      TRIANGULATION_ORDER6</a>  
      is a data directory containing a description
      and examples of an order 6 triangulation.
    </p>

    <p>
      <a href = "../triangulation_plot/triangulation_plot.html">
      TRIANGULATION_PLOT</a> 
      is an executable FORTRAN90 program which 
      can be used to plot the elements that triangulate the region.
    </p>

    <p>
      <a href = "https://people.math.sc.edu/Burkardt/m_src/vector_arrows/vector_arrows.html">
      VECTOR_ARROWS</a>  
      is a MATLAB program that 
      can be used to plot the vector field.
    </p>

    <p>
      <a href = "../vector_plot/vector_plot.html">
      VECTOR_PLOT</a>  
      is an executable FORTRAN90 program that 
      can be used to plot the vector field.
    </p>

    <h3 align = "center">
      Reference:
    </h3>

    <p>
      <ol>
        <li>
          Max Gunzburger,<br>
          Finite Element Methods for Viscous Incompressible Flows,<br>
          A Guide to Theory, Practice, and Algorithms,<br>
          Academic Press, 1989,<br>
          LC: TA357.G86
        </li>
      </ol>
    </p>

    <h3 align = "center">
      Source Code:
    </h3>

    <p>
      <ul>
        <li>
          <a href = "flow7.f90">flow7.f90</a>, the source code;
        </li>
        <li>
          <a href = "https://people.math.sc.edu/Burkardt/f_src/flow7/flow7.csh">flow7.csh</a>, 
          commands to compile and load the source code;
        </li>
      </ul>
    </p>

    <h3 align = "center">
      List of Routines:
    </h3>

    <p>
      <ul>
        <li>
          <b>MAIN</b> is the main program for FLOW7.
        </li>
        <li>
          <b>BOUNDARY_INTEGRAL</b> sets data useful for boundary integrals.
        </li>
        <li>
          <b>BOUNDARY_INTEGRAL_FREESLIP</b> sets boundary integral data for the freeslip.
        </li>
        <li>
          <b>BOUNDARY_INTEGRAL_STEP</b> sets boundary integral data for the step.
        </li>
        <li>
          <b>BOUNDARY_INTEGRAL_PRINT</b> prints data useful for boundary integrals.
        </li>
        <li>
          <b>BOUNDARY_SHAPE</b> returns the tangent and normal vectors along the boundary.
        </li>
        <li>
          <b>BOUNDARY_SHAPE_CAVITY</b> returns the boundary of the cavity problem.
        </li>
        <li>
          <b>BOUNDARY_SHAPE_CHANNEL</b> returns the boundary of the channel problem.
        </li>
        <li>
          <b>BOUNDARY_SHAPE_FREESLIP</b> returns the boundary of the freeslip problem.
        </li>
        <li>
          <b>BOUNDARY_SHAPE_STEP</b> returns the boundary of the step problem.
        </li>
        <li>
          <b>BOUNDARY_VALUE</b> evaluates boundary condition functions.
        </li>
        <li>
          <b>CH_CAP</b> capitalizes a single character.
        </li>
        <li>
          <b>COEF_READ</b> reads the coefficient data from a file.
        </li>
        <li>
          <b>COEF_WRITE</b> writes the coefficient data to a file for possible restart.
        </li>
        <li>
          <b>ELEMENT_PRINT</b> prints out the elements.
        </li>
        <li>
          <b>ELEMENT_WRITE</b> writes element information to a file.
        </li>
        <li>
          <b>EQN_NABOR_PRINT</b> prints the equation neighbor array.
        </li>
        <li>
          <b>EQN_NABOR_SET</b> sets up the equation neighbor array.
        </li>
        <li>
          <b>EQUATION_PRINT</b> prints the equation types.
        </li>
        <li>
          <b>FP</b> computes the jacobian matrix A of the Navier Stokes residual. 
        </li>
        <li>
          <b>FP_BAND_INFO_PRINT</b> prints information about the banded jacobian.
        </li>
        <li>
          <b>FP_BAND_WIDTH</b> computes the lower band width of the Jacobian matrix.
        </li>
        <li>
          <b>FP_DIF</b> estimates the jacobian matrix by finite differences.
        </li>
        <li>
          <b>FX</b> computes the residual of the Navier Stokes equations.
        </li>
        <li>
          <b>GEOMETRY</b> sets up the geometry for any problem.
        </li>
        <li>
          <b>GEOMETRY_CAVITY</b> sets up the geometry for the cavity problem.
        </li>
        <li>
          <b>GEOMETRY_CHANNEL</b> sets up the geometry for the channel problem.
        </li>
        <li>
          <b>GEOMETRY_FREESLIP</b> sets up the geometry for the freeslip problem.
        </li>
        <li>
          <b>GEOMETRY_STEP</b> sets up the geometry for the step problem.
        </li>
        <li>
          <b>GET_UNIT</b> returns a free FORTRAN unit number.
        </li>
        <li>
          <b>HELLO</b> says hello, prints the program name, date and limits.
        </li>
        <li>
          <b>INIT</b> zeroes out data used by the program.
        </li>
        <li>
          <b>I4VEC_MERGE_A</b> merges two ascending sorted integer arrays.
        </li>
        <li>
          <b>I4VEC_ORDER_TYPE</b> determines if an integer array is (non)strictly ascending/descending.
        </li>
        <li>
          <b>I4VEC_SORT_BUBBLE_A</b> ascending sorts an integer array using bubble sort.
        </li>
        <li>
          <b>NODE_NABOR_PRINT</b> prints the node neighbor array.
        </li>
        <li>
          <b>NODE_NABOR_SET</b> sets up the node neighbor array.
        </li>
        <li>
          <b>NEWTON</b> applies Newton iteration, seeking a solution of FX(G) = 0.
        </li>
        <li>
          <b>NODE_WRITE</b> writes solution information to a file.
        </li>
        <li>
          <b>PRESS_INTERP</b> interpolates pressure values at non-pressure nodes.
        </li>
        <li>
          <b>R4VEC_AMAX</b> returns the maximum absolute value in an R4VEC.
        </li>
        <li>
          <b>REF_BF_L3</b> evaluates a reference element linear basis function.
        </li>
        <li>
          <b>REF_BF_Q6</b> evaluates shape functions for a 6 node triangle.
        </li>
        <li>
          <b>REF_MAP_Q6</b> returns the interpolation map for data on a 6 node triangle.
        </li>
        <li>
          <b>REF_QUAD1</b> sets abscissas and wquad1s for 1D Gauss-Legendre quadrature.
        </li>
        <li>
          <b>REF_QUAD2</b> sets up the 2D reference triangle quadrature rule.
        </li>
        <li>
          <b>S_EQI</b> is a case insensitive comparison of two strings for equality.
        </li>
        <li>
          <b>SETBAS</b> evaluates the basis functions at each quadrature point.  
        </li>
        <li>
          <b>SGB_CHECK</b> checks the dimensions of a general band matrix.
        </li>
        <li>
          <b>SGB_FA</b> factors a matrix stored in LINPACK general band storage.
        </li>
        <li>
          <b>SGB_PRINT</b> prints nonzero entries of a banded matrix.
        </li>
        <li>
          <b>SGB_SL</b> solves a system factored by DGB_FA.
        </li>
        <li>
          <b>STOKES</b> solves the Stokes equations.
        </li>
        <li>
          <b>TIMESTAMP</b> prints the current YMDHMS date as a time stamp.
        </li>
        <li>
          <b>TRANS_Q6</b> calculates the biquadratic reference element transformation.
        </li>
        <li>
          <b>UVP_NORM_H1</b> returns the H1 norm of the solution.
        </li>
        <li>
          <b>UVP_NORM_L2</b> returns the L2 norms of velocity magnitude, and pressure.  
        </li>
        <li>
          <b>UVP_NORM_LMAX</b> returns the infinity norms of velocity magnitude and pressure.
        </li>
        <li>
          <b>UVP_PRINT</b> prints out the solution.
        </li>
        <li>
          <b>UVP_QUAD_VALUE</b> evaluates U, V and P at a quadrature point in a given element.
        </li>
        <li>
          <b>UVP_VALUE</b> evaluates U, V and P at any point in a given element.
        </li>
        <li>
          <b>X_OF_XSI</b> computes X and Y given XSI and ETA coordinates.
        </li>
        <li>
          <b>XY_PRINT</b> prints the X and Y coordinates of the nodes.
        </li>
      </ul>
    </p>

    <p>
      You can go up one level to <a href = "../f_src.html">
      the FORTRAN90 source codes</a>.
    </p>

    <hr>

    <i>
      Last revised on 17 January 2007.
    </i>

  </body>

</html>
